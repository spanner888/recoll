= Recoll on Windows
Jean-Francois Dockes <jf at dockes.org>
:date:

:recollversion: 1.23.0-20170107-78b8ad

image:recoll-windows10-thumb.png[link="recoll-windows10.png"]

Recoll for Windows was built on Windows 7, and tried on Windows 7 and
10. It does not work on Windows XP.

Recoll is free and licensed under the GPL. You will be asked to accept the
license during the installation. For a regular user, and in a nutshell, the
license means that you are free to do what you want with the program (use,
copy, share, etc.). If you are a developper and intend to modify and
distribute the program, you probably know the GPL, else you should read it.

NOTE: As much as I have fun writing software, producing the Windows version is
just tedious. If you use Recoll on Windows, please consider contributing to
its availability: image:/donations/btn_donate_LG.gif[link="/donations/index.html"]

== Note for updating

Recoll versions 1.23.0-9c5e32-20161216 and 1.23.0-2bfd80-20161115 had been
switched to using Xapian 1.4 which has a new and different index
format. Due to issues in Xapian 1.4, I have switched back to using Xapian
1.2 as of Recoll 1.23.0-20170107-78b8ad.

This simply means that, if your index was created by one of the above
versions, it will have to be recreated from scratch after installing the
current Recoll version. I advise explicitely deleting
$HOME/AppData/Local/Recoll/xapiandb, as this will avoid leaving around 1.4
files which would take space for nothing otherwise.

== Installation

- Download the 
  http://www.recoll.org/windows/recoll-setup-{recollversion}.exe[Recoll
  setup file].

- Execute the setup file. This is a vanilla installer generated by Inno
  Setup, and it will ask the usual questions.

- Download and install Python 2.7.10 or 2.7.11 (e.g.
  https://www.python.org/ftp/python/2.7.11/python-2.7.11.msi[Python
  2.7.11]). Recoll currently does not work with Python3. *_On the
  `Customize installation` screen, select "Add python.exe to Path"_*

- Optional: download and install the 7-zip program from
  http://www.7-zip.org/. This is only useful if you need to index files
  compressed with Unix methods (not needed for zip files).

NOTE: The installer needs administrator rights in order to install to
`C:\Program Files`. If you want to install on a machine where you have no
administrator rights, you can use the
http://www.recoll.org/windows/recoll-{recollversion}.7z[installation
directory archive] instead and extract it anywhere, this works just the
same (you will need the free http://www.7-zip.org/[7z] to extract it). If
you are in this case, you can ignore the setup-related steps of the
procedure of course.

== Configuration

- Start recoll. It will ask if you want to customize the configuration.
  The default is to index the content of your user directory. Then start
  indexing. This can take some time.
- The default result list font is particularly ugly. Change it from 
  `Preferences->GUI Configuration->Result List->Result List Font`

- Have a look at the
  https://www.lesbonscomptes.com/recoll/usermanual/webhelp/docs/index.html[Recoll
manual] !
- I have also started a small link:recoll-windows-faq.html[Recoll on
  MS-Windows FAQ]. 

== Support

Please use the 
https://bitbucket.org/medoc/recoll/issues[BitBucket Recoll issues tracker]
for reporting problems, or contact me by email: jfd at recoll.org.


== Known problems:

- Setting the log level to 4 or higher can cause the GUI to deadlock while
  displaying results. This will be fixed shortly.
  
- Indexing is very slow, especially when using external commands (e.g. for
  PDF files). I don't know if this is a case of my doing something stupid,
  or if the general architecture is really bad fitted for Windows. If
  someone with good Windows programming knowledge reads this, I'd be very
  interested by a discussion. Windows indexing can be ten times slower than
  the Linux version. The index formats are compatible, so, if you have
  shared Linux/Windows data, it's best to process it on Linux.

- Filtering by directory location ('dir:' clauses) used to be
  case-sensitive, including drive letters. This is hopefully fixed by the
  November 2016 version.

- Also, when filtering the search with a `dir:` clause, an absolute path
  should be specified as `/c/mydir` instead of `c:/mydir`

- There is no real-time or scheduled indexing as on Linux. For now, you
  create and update the index by using the `File` menu (or executing
  `recollindex.exe` from a command window).

== Change Log

Changes in 20161115

- File path names case sensitivity and other small path issues should be fixed.
- Based on Xapian 1.4. New stemming languages are available (e.g. Arabic).
- Fixed date display encoding issues.

Changes in 20160414

- The setup script has changed back to needing administrator rights,
  because this is what is convenient for most people. Use the installation
  directory archive to install in a non-standard location without admin
  rights.
- Fixed a bug which had the whole indexing stop if a script would time out
  on a specific file (it will very rarely happen that a pathologically bad
  file can throw an input handler in a loop).


Changes in 20160317

- Small change to the setup script so that administrative rights are not
  required. 

Changes/fixes in 20160129

- Changed the method used for checking that index data is up to date with
  documents. This will impose a re-indexing of all data, but it was
  necessary because the previous method was incorrect.
- Fixed crash which occured after changing some configuration parameters.
- Warn when editing a temporary copy of a document (e.g. a temp file
  extracted from a zip archive.
  
Changes in 20151202

- Fixed mbox parsing. This was getting the message separators completely
  wrong, and taking a lot of time to do it. This should be especially
  welcome by Thunderbird users.

- Fixed email attachement processing. A fault in the code which saved
  attachment data to disk for further processing resulted in a practical
  fuzzing experiment on the input processors. Especially, frequent crashes
  in the image tag extractor caused very ennoying Windows popups about
  a Python error.

Fixed in 20151115 and later

- A relatively rare crash which seemed to occur mostly on some email
  messages
- Forgotten MIME settings for .cs, .js and .css

Fixed in 20151112 and later

- Forgotten dll prevents the unrtf program to work, so no rtf indexing.

Fixed in 20151109 (hopefully?)

- The GUI sometimes crashes when you click `Preview` or `Open`. This does
  not occur often, and usually for one of the first tries after starting
  the program. Don't despair. This seems to be fixed in the latest version
  (20151109), but I am not 100% certain that it is gone.

++++
<h2 id="comments">Comments</h2>

      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_shortname = 'lesbonscomptes'; 
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
++++
